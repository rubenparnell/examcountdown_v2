{% extends "base.html" %}
{% block title %}Reset Password{% endblock %}

{% block content %}
<div class="container">
    <h2 class="bold my-4">Reset Password</h2>
    <form method="POST" id="resetForm">
        {{ form.hidden_tag() }}

        <!-- hidden field to store token -->
        <input type="hidden" name="access_token" id="access_token">

        <div class="form-floating mb-3">
            {{ form.password1(class="form-control", placeholder="Password") }}
            <label for="floatingInput">{{ form.password1.label }}</label>
        </div>

        <div class="form-floating mb-3">
            {{ form.password2(class="form-control", placeholder="Confirm Password") }}
            <label for="floatingInput">{{ form.password2.label }}</label>
        </div>

        {{ form.submit(class="btn btn-primary") }}
    </form>
</div>

<script>
    // Grab access_token from the URL hash
    const hashParams = new URLSearchParams(window.location.hash.substring(1));
    const token = hashParams.get("access_token");

    if (token) {
        document.getElementById("access_token").value = token;
    } else {
        document.getElementById("resetForm").innerHTML = "<p>Invalid or missing reset token.</p>";
    }
</script>
{% endblock %}
